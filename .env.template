# ===============================================================================
# STORM CLOUD SERVER - ENVIRONMENT CONFIGURATION
# ===============================================================================
# This file serves TWO deployment scenarios:
#
# 1. LOCAL DEVELOPMENT (SQLite + runserver):
#    - DJANGO_SETTINGS_MODULE defaults to _core.settings.dev
#    - Keep DATABASE_URL as sqlite:///db.sqlite3
#    - Run: python manage.py runserver
#
# 2. DOCKER DEPLOYMENT (PostgreSQL + gunicorn):
#    - DJANGO_SETTINGS_MODULE set to _core.settings.production (in Dockerfile)
#    - Set POSTGRES_PASSWORD to a strong password
#    - Run: docker compose up -d
#
# See DOCKER.md for Docker setup instructions.
# ===============================================================================

# Django Settings Module (optional - defaults set in manage.py/wsgi.py)
# Leave commented for defaults:
# - manage.py runserver uses: _core.settings.dev
# - gunicorn/Docker uses: _core.settings.production
# DJANGO_SETTINGS_MODULE=_core.settings.dev

# Django Core Settings
# REQUIRED: Change this in production! Generate with:
# python -c 'from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())'
SECRET_KEY=your-secret-key-here-change-in-production

# Set to False in production
DEBUG=True

# Comma-separated list of allowed hostnames
ALLOWED_HOSTS=localhost,127.0.0.1,0.0.0.0

# ===============================================================================
# DOCKER CONFIGURATION
# ===============================================================================
# Project name prefix for containers (optional, default: stormcloud)
COMPOSE_PROJECT_NAME=stormcloud

# Web server port (optional, default: 8000)
WEB_PORT=8000

# Domain for reverse proxy (optional, used with Traefik labels)
# DOMAIN=stormcloud.yourdomain.com

# ===============================================================================
# DATABASE CONFIGURATION
# ===============================================================================
# Local dev uses SQLite (no config needed)
# Docker uses PostgreSQL (set POSTGRES_PASSWORD below)

# PostgreSQL Configuration (Docker only - ignored in local dev)
POSTGRES_DB=stormcloud
POSTGRES_USER=stormcloud
POSTGRES_HOST=db
POSTGRES_PASSWORD=change-this-secure-password

# Email Configuration
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
# For production SMTP:
# EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
# EMAIL_HOST=smtp.example.com
# EMAIL_PORT=587
# EMAIL_USE_TLS=True
# EMAIL_HOST_USER=your-email@example.com
# EMAIL_HOST_PASSWORD=your-password
DEFAULT_FROM_EMAIL=noreply@stormcloud.local

# Storm Cloud Configuration
STORMCLOUD_ALLOW_REGISTRATION=False
STORMCLOUD_REQUIRE_EMAIL_VERIFICATION=True
STORMCLOUD_EMAIL_VERIFICATION_EXPIRY_HOURS=24
STORMCLOUD_MAX_API_KEYS_PER_USER=0
STORMCLOUD_ALLOW_UNLIMITED_SHARE_LINKS=True
STORMCLOUD_DEFAULT_SHARE_EXPIRY_DAYS=7

# CORS Configuration (comma-separated list)
# Example: STORMCLOUD_CORS_ORIGINS=https://myapp.com,http://localhost:3000
STORMCLOUD_CORS_ORIGINS=

# Storage Configuration
STORMCLOUD_STORAGE_BACKEND=core.storage.local.LocalStorageBackend

# IMPORTANT FOR DOCKER: Set these paths to use mounted volumes
# Without these, files are stored INSIDE the container and lost on rebuild!
# For Docker development, uncomment these lines:
# STORMCLOUD_STORAGE_ROOT=/app/storage_root
# STORMCLOUD_SHARED_STORAGE_ROOT=/app/shared_storage

# For local dev (runserver), defaults work fine:
# STORMCLOUD_STORAGE_ROOT defaults to {BASE_DIR}/storage_root
# STORMCLOUD_SHARED_STORAGE_ROOT defaults to {BASE_DIR}/shared_storage

# Encryption (ADR 006, ADR 010)
# Method: 'none' (default), 'server' (AES-256-GCM master key)
STORAGE_ENCRYPTION_METHOD=none
# Required when method != 'none'. Generate with:
#   python -c "import secrets; print(secrets.token_urlsafe(32))"
STORAGE_ENCRYPTION_KEY=
# Key identifier for rotation (increment when rotating keys)
STORAGE_ENCRYPTION_KEY_ID=1

# Rate Limiting (see ADR 007)
# Format: number/period where period can be: second, minute, hour, day
THROTTLE_LOGIN_RATE=5/min
THROTTLE_AUTH_RATE=10/hour
THROTTLE_UPLOAD_RATE=100/hour
THROTTLE_DOWNLOAD_RATE=500/hour
THROTTLE_USER_RATE=1000/hour
THROTTLE_ANON_LOGIN_RATE=10/hour
THROTTLE_ANON_REGISTRATION_RATE=5/hour
THROTTLE_PUBLIC_SHARE_RATE=60/min
THROTTLE_PUBLIC_SHARE_DOWNLOAD_RATE=30/min

# ===============================================================================
# PRODUCTION SECURITY SETTINGS
# ===============================================================================
# IMPORTANT: These settings are ONLY for production deployment behind HTTPS.
# Do NOT enable these in local development or without a reverse proxy (nginx/Caddy).
# See SECURITY.md for detailed explanations and DOCKER.md for deployment guide.

# SSL/TLS Redirect
# Default: False (reverse proxy handles HTTPâ†’HTTPS redirect)
# Set to True ONLY if Django should handle redirects (not recommended)
# SECURE_SSL_REDIRECT=False

# HTTP Strict Transport Security (HSTS)
# Default: 31536000 (1 year)
# WARNING: Once enabled, browsers will refuse HTTP for the specified duration.
# Start with a low value (300 = 5 minutes) for testing, then increase gradually.
# See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security
# SECURE_HSTS_SECONDS=31536000
# SECURE_HSTS_INCLUDE_SUBDOMAINS=True
# SECURE_HSTS_PRELOAD=True

# Secure Cookies (HTTPS only)
# Default: True (requires HTTPS to function)
# These MUST be True for production. Set to False ONLY for local HTTP testing.
# SESSION_COOKIE_SECURE=True
# CSRF_COOKIE_SECURE=True

# Additional Security Headers (configured automatically in production)
# - X-Content-Type-Options: nosniff
# - X-Frame-Options: DENY
# - X-XSS-Protection: 1; mode=block
